<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>RFC 6455 WebSockets for Racket</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">RFC 6455 Web<span class="mywbr"> &nbsp;</span>Sockets for Racket</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Changes%29" class="tocviewlink" data-pltdoc="x">Changes</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Synopsis%29" class="tocviewlink" data-pltdoc="x">Synopsis</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.License%29" class="tocviewlink" data-pltdoc="x">License</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.A.P.I%29" class="tocviewlink" data-pltdoc="x">API</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">RFC 6455 Web<span class="mywbr"> &nbsp;</span>Sockets for Racket</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Changes%29" class="tocsubseclink" data-pltdoc="x">Changes</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Synopsis%29" class="tocsubseclink" data-pltdoc="x">Synopsis</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.License%29" class="tocsubseclink" data-pltdoc="x">License</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.A.P.I%29" class="tocsubseclink" data-pltdoc="x">API</a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-url~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>url?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._wss-url~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">wss-<wbr></wbr>url?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-fragmentation~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>supports-<wbr></wbr>fragmentation?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-payload-type~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>supports-<wbr></wbr>payload-<wbr></wbr>type?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-signals-status-on-close~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>signals-<wbr></wbr>status-<wbr></wbr>on-<wbr></wbr>close?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-closed~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>closed?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-status%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>close-<wbr></wbr>status</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-reason%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>conn-<wbr></wbr>close-<wbr></wbr>reason</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-connect%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>connect</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>serve</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>serve*</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._net%2Frfc6455..rkt%29._ws-service-mapper%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">ws-<wbr></wbr>service-<wbr></wbr>mapper</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>send!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>recv</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-evt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>recv-<wbr></wbr>evt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-stream%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>recv-<wbr></wbr>stream</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-close%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>close!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._rfc6455-stream-buffer-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">rfc6455-<wbr></wbr>stream-<wbr></wbr>buffer-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._hybi00-framing-mode%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">hybi00-<wbr></wbr>framing-<wbr></wbr>mode</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-idle-timeout%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ws-<wbr></wbr>idle-<wbr></wbr>timeout</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">2.1.0</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.14&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.14&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.14&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;top&quot;" class="heading"><a name="(part._top)"></a><a name="(part._.R.F.C_6455_.Web.Sockets_for_.Racket)"></a>RFC 6455 WebSockets for Racket<span class="button-group"><a href="#(part._top)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tony Garnock-Jones &lt;<a href="mailto:tonygarnockjones@gmail.com">tonygarnockjones@gmail.com</a>&gt;</p></span></div><h3 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;Introduction&quot;" class="heading">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction<span class="button-group"><a href="#(part._.Introduction)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p>This package, <span class="stt">rfc6455</span>, provides
<a href="http://tools.ietf.org/html/rfc6455">RFC 6455</a> compatible
WebSockets server and client interfaces for Racket, building on Racket&rsquo;s
<span class="RktSym">web-server</span> collection.</p><p>Besides support for RFC 6455, the final WebSockets standard, the
package also incorporates code supporting the earlier, draft
<a href="http://tools.ietf.org/html/draft-ietf-hybi-thewebsocketprotocol-00">hybi-00</a>
proposal, because several common older browsers still use this
protocol variant.</p><p>Wikipedia has a
<a href="http://en.wikipedia.org/wiki/WebSocket#Browser_implementation">section
on browser support for WebSocket protocol variations</a>. In 2013, at the
time this manual was written, it stated that "all the latest browsers
except Android browser support the latest specification (RFC 6455) of
the WebSocket protocol." For up-to-date, detailed information on
browser support for WebSockets, see
<a href="https://caniuse.com/#search=WebSockets">caniuse.com</a>.</p><p>This package has been developed against</p><ul><li><p>Firefox 24.0 (which is an RFC 6455 peer)</p></li><li><p>Chrome 30.0.1599.101 (which is an RFC 6455 peer)</p></li><li><p>Safari 5.1.10 (which is a hybi-00 peer)</p></li></ul><h3 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;Changes&quot;" class="heading">2<tt>&nbsp;</tt><a name="(part._.Changes)"></a>Changes<span class="button-group"><a href="#(part._.Changes)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p>Version 2.1.0 of this library introduces <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-status%29%29" class="RktValLink" data-pltdoc="x">ws-conn-close-status</a></span>
and <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-reason%29%29" class="RktValLink" data-pltdoc="x">ws-conn-close-reason</a></span> for retrieving information from
close frames sent by remote peers.</p><p>Version 2.0.0 of this library introduces a new interface to streaming
message reception, <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-stream%29%29" class="RktValLink" data-pltdoc="x">ws-recv-stream</a></span>, and makes a breaking
change to the way <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span> values work as <font class="badlink"><span class="techoutside"><span class="techinside">synchronizable event</span></span></font>s. The
<font class="badlink"><span class="techoutside"><span class="techinside">synchronization result</span></span></font> of such an event is now a received message, where
previously it was an uninteresting value. See the (new) procedure
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-evt%29%29" class="RktValLink" data-pltdoc="x">ws-recv-evt</a></span>.</p><p>In addition, prior to version 2.0.0, the default
<span class="RktPn">#:payload-type</span> for <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span> was actually
<span class="RktVal">'</span><span class="RktVal">text</span>, even though the documentation claimed that it was
<span class="RktVal">'</span><span class="RktVal">auto</span>. From version 2.0.0, the default is <span class="RktVal">'</span><span class="RktVal">auto</span> in
both the documentation and the implementation.</p><p>Version 1.0.1 of this library is the last version with the old
<span class="RktPn">#:stream?</span> interface to streaming receives. It also has an
interface bug: when (1) using a <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span> as an
<font class="badlink"><span class="techoutside"><span class="techinside">synchronizable event</span></span></font>, (2) with an event-handler that calls
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span>, (3) connected to a client that occasionally sends
websocket "ping" frames, the call to <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span> may get stuck
waiting for the next non-"ping" frame, leading to a kind of temporary
stall on the thread invoking <span class="RktSym"><span class="badlink"><span class="RktValLink">sync</span></span></span>. This bug was the chief
motivation for the changes of version 2.0.0.</p><h3 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;Synopsis&quot;" class="heading">3<tt>&nbsp;</tt><a name="(part._.Synopsis)"></a>Synopsis<span class="button-group"><a href="#(part._.Synopsis)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p>Using the legacy <span class="RktSym">net/websocket</span><span class="RktMeta"></span>-compatible interface:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">net/rfc6455</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%29%29" class="RktValLink" data-pltdoc="x">ws-serve</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:port</span><span class="hspace">&nbsp;</span><span class="RktVal">8081</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lambda</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hello world!"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Using an interface that supports URL path matching and WebSocket
subprotocol selection:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">net/rfc6455</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%2A%29%29" class="RktValLink" data-pltdoc="x">ws-serve*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:port</span><span class="hspace">&nbsp;</span><span class="RktVal">8081</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._net%2Frfc6455..rkt%29._ws-service-mapper%29%29" class="RktStxLink" data-pltdoc="x">ws-service-mapper</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"/test"</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the URL path (regular expression)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">subprotocol</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if client requests subprotocol "subprotocol"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lambda</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">"You requested a subprotocol"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if client did not request any subprotocol</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lambda</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">"You didn't explicitly request a subprotocol"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Creating a client connection:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">net/rfc6455</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">net/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-connect%29%29" class="RktValLink" data-pltdoc="x">ws-connect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl..rkt%2529._string-%7E3eurl%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">string-&gt;url</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"ws://localhost:8081/"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hello world!"</span><span class="RktPn">)</span></td></tr></table></blockquote><h3 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;License&quot;" class="heading">4<tt>&nbsp;</tt><a name="(part._.License)"></a>License<span class="button-group"><a href="#(part._.License)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p>All the code in this package is licensed under the LGPL, version 3.0
or any later version. Each source file has a brief copyright and
licensing notice attached, but see
<a href="http://www.gnu.org/licenses/lgpl-3.0.txt">the licence text
itself</a> for full details.</p><p>The only exceptions to the above are the files marked "public domain"
in the <span class="stt">net/rfc6455/examples</span> directory. They are intended to be
examples of usage of the package for people to build on without
concern for licensing minutiae.</p><h3 x-source-module="(lib &quot;net/rfc6455/scribblings/rfc6455.scrbl&quot;)" x-source-pkg="rfc6455" x-part-tag="&quot;API&quot;" class="heading">5<tt>&nbsp;</tt><a name="(part._.A.P.I)"></a><a name="(mod-path._net/rfc6455)"></a>API<span class="button-group"><a href="#(part._.A.P.I)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="stt"> </span><a href="#%28mod-path._net%2Frfc6455%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">net/rfc6455</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/rfc6455" title="Install this package using `raco pkg install rfc6455`"><span class="stt">rfc6455</span></a></span></td></tr></table></p><p>The interface is based on the <span class="RktSym">net/websocket</span><span class="RktMeta"></span> API from older
versions of Racket, with some extensions and differences.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-url~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-url~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-url?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns true if and only if <span class="RktVar">x</span> is a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl-structs..rkt%2529._url%7E3f%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">url?</a></span> and has a
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl-structs..rkt%2529._url-scheme%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">url-scheme</a></span> equal to <span class="RktVal">"ws"</span> or <span class="RktVal">"wss"</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._wss-url~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._wss-url~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">wss-url?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns true if and only if <span class="RktVar">x</span> is a <span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl-structs..rkt%2529._url%7E3f%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">url?</a></span> and has a
<span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl-structs..rkt%2529._url-scheme%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">url-scheme</a></span> equal to <span class="RktVal">"wss"</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if <span class="RktVar">x</span> is a WebSocket
connection as defined by this package.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-supports-fragmentation~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-fragmentation~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-supports-fragmentation?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktVal">#t</span> iff the connected peer supports sending and receiving
fragmented/streamed messages. Currently, RFC 6455-compliant peers
support fragmentation, while hybi-00 peers do not.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-supports-payload-type~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-payload-type~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-supports-payload-type?</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">c</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">payload-type</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">payload-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">symbol?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktVal">#t</span> iff the connected peer supports the requested payload
type. RFC 6455-compliant peers support types <span class="RktVal">'</span><span class="RktVal">text</span> and
<span class="RktVal">'</span><span class="RktVal">binary</span>, while hybi-00 peers support only <span class="RktVal">'</span><span class="RktVal">text</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-signals-status-on-close~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-signals-status-on-close~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-signals-status-on-close?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktVal">#t</span> iff the <span class="RktSym">status</span> and/or <span class="RktSym">reason</span> values are
communicated to the remote peer on connection
close (<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-close%21%29%29" class="RktValLink" data-pltdoc="x">ws-close!</a></span>). RFC 6455 includes space in the wire
protocol for these values, while hybi-00 does not.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-closed~3f))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-closed~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-closed?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if the given connection has been closed, and
<span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-close-status))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-status%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-close-status</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-conn-close-reason))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-close-reason%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-conn-close-reason</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">When <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-closed~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-closed?</a></span> returns <span class="RktVal">#t</span>, these procedures
will respectively retrieve the "status code" and "reason" text from
the close frame sent by the remote peer that caused the connection
shutdown. If no such information is available, they will return
<span class="RktVal">#f</span>. Only RFC 6455 peers send information in their close
frames; hybi-00 connections will always yield <span class="RktVal">#f</span> from these
procedures.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-connect))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-connect%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-connect</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">u</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:headers</span><span class="hspace">&nbsp;</span><span class="RktVar">headers</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:protocol</span><span class="hspace">&nbsp;</span><span class="RktVar">protocol</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">u</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-url~3f%29%29" class="RktValLink" data-pltdoc="x">ws-url?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._wss-url~3f%29%29" class="RktValLink" data-pltdoc="x">wss-url?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">headers</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">header?</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">rfc6455</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">hybi00</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">rfc6455</span></td></tr></table></blockquote></div><div class="SIntrapara">Connect to the given WebSockets server, via TLS if <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._wss-url~3f%29%29" class="RktValLink" data-pltdoc="x">wss-url?</a></span><span class="stt"> </span><span class="RktVar">u</span><span class="RktPn">)</span>. Supplies <span class="RktVar">headers</span> as additional headers in the WebSocket
handshake request. A protocol variant other than the RFC 6455 standard
can be chosen by supplying a value for the <span class="RktPn">#:protocol</span>
parameter.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-serve))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-serve</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">conn-dispatch</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:conn-headers</span><span class="hspace">&nbsp;</span><span class="RktVar">conn-headers</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn-dispatch</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">request?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">conn-headers</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">bytes?</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">header?</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">request?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">values</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">header?</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">bytes?</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">header?</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">values</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">header?</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">This is a convenience entry point, largely directly compatible with
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%29%29" class="RktValLink" data-pltdoc="x">ws-serve</a></span><span class="RktMeta"></span> from the built-in websocket support in older versions
of Racket, including all its arguments besides those
shown. If <span class="RktPn">#:conn-headers</span> is supplied, then it is inspected to
see whether it takes two or three arguments, and is called
appropriately.</div></p><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-serve*))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-serve*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">service-mapper</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">service-mapper</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/8.14/doc/local-redirect/index.html?doc=net&amp;rel=url.html%23%2528def._%2528%2528lib._net%252Furl-structs..rkt%2529._url%7E3f%2529%2529&amp;version=8.14" class="RktValLink Sq" data-pltdoc="x">url?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">symbol?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote><p>Like <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%29%29" class="RktValLink" data-pltdoc="x">ws-serve</a></span>, except uses the given <span class="RktSym">service-mapper</span>
to decide how to handle an incoming request. See
<span class="RktSym"><a href="#%28form._%28%28lib._net%2Frfc6455..rkt%29._ws-service-mapper%29%29" class="RktStxLink" data-pltdoc="x">ws-service-mapper</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._net/rfc6455..rkt)._ws-service-mapper))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28form._%28%28lib._net%2Frfc6455..rkt%29._ws-service-mapper%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">ws-service-mapper</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">uri-regexp</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">function-expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">protocol</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">symbol</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Macro that expands to an expression suitable for use as a
service-mapper with <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-serve%2A%29%29" class="RktValLink" data-pltdoc="x">ws-serve*</a></span>.</div></p><p>Each <span class="RktVar">uri-regexp</span> is matched against an incoming request&rsquo;s URL
in turn until one matches. Then,</p><ul><li><p>if the client supplied a <span class="stt">Sec-WebSocket-Protocol</span> header,
each token from that header is checked against the <span class="RktVar">protocol</span>s
in turn. If one matches, the corresponding <span class="RktVar">function-expr</span> is
used as the connection handler; or,</p></li><li><p>if no such header was supplied, the first
<span class="RktVar">function-expr</span> with a literal <span class="RktVal">#f</span> among its
<span class="RktVar">protocol</span>s is used.</p></li></ul><p>The <span class="RktVar">function-expr</span>s must evaluate to connection handler
procedures, each taking a <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span> as their only argument.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-send!))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-send!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">c</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">payload</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:final-fragment?</span><span class="hspace">&nbsp;</span><span class="RktVar">final-fragment?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:payload-type</span><span class="hspace">&nbsp;</span><span class="RktVar">payload-type</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:flush?</span><span class="hspace">&nbsp;</span><span class="RktVar">flush?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">payload</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">bytes?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">input-port?</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">final-fragment?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">payload-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">continuation</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">text</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">binary</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">text</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">flush?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></blockquote></div><div class="SIntrapara">Sends a message to the remote peer.</div></p><p>(Note: Only RFC 6455 peers support fragmentation and non-text
payloads. Attempts to use these features with hybi-00 peers will
signal an error. See <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-fragmentation~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-supports-fragmentation?</a></span> and
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-payload-type~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-supports-payload-type?</a></span>.)</p><p>If <span class="RktVar">payload</span> is a string, it is converted to bytes using
<span class="RktSym"><span class="badlink"><span class="RktValLink">string-&gt;bytes/utf-8</span></span></span> before transmission. If it is an
input-port, it is read from and streamed using multiple WebSockets
message fragments to the peer until it yields <span class="RktSym"><span class="badlink"><span class="RktValLink">eof</span></span></span> (see also
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._rfc6455-stream-buffer-size%29%29" class="RktValLink" data-pltdoc="x">rfc6455-stream-buffer-size</a></span>).</p><p>If <span class="RktVar">flush?</span> is false, the buffers of the underlying connection
socket output-ports are not flushed after sending the message.
Otherwise (i.e. by default), they are flushed.</p><p>If <span class="RktVar">payload-type</span> is <span class="RktVal">'</span><span class="RktVal">text</span> or <span class="RktVal">'</span><span class="RktVal">binary</span>, the
appropriate WebSockets content type bit is set upon transmission.</p><p>Fragmented messages can be sent using this procedure.</p><ul><li><p>The first fragment in a sequence must have
<span class="RktVar">payload-type</span> set to <span class="RktVal">'</span><span class="RktVal">text</span> or <span class="RktVal">'</span><span class="RktVal">binary</span>. Every
subsequent fragment in the same sequence must have
<span class="RktVar">payload-type</span> set to <span class="RktVal">'</span><span class="RktVal">continuation</span>.</p></li><li><p>The final fragment in a sequence must have
<span class="RktVar">final-fragment?</span> set to a non-false value. Every other
fragment in a sequence must have <span class="RktVar">final-fragment?</span> set to
<span class="RktVal">#f</span>.</p></li></ul><p>For single-fragment (unfragmented) messages, the defaults are fine: a
plain <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="stt"> </span><span class="RktVar">c</span><span class="stt"> </span><span class="RktVar">payload</span><span class="RktPn">)</span> is enough. Here is an example of a
multi-fragment message:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span><span class="RktVal">#"first"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:final-fragment?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span><span class="RktVal">#"second"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:final-fragment?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">#:payload-type</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">continuation</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span><span class="RktVal">#"third"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:final-fragment?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktPn">#:payload-type</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">continuation</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-recv))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-recv</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:payload-type</span><span class="hspace">&nbsp;</span><span class="RktVar">payload-type</span><span class="RktOpt">]</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">eof-object?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">bytes?</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">payload-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">auto</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">text</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">binary</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">auto</span></td></tr></table></blockquote></div><div class="SIntrapara">Receives a message from the remote peer.</div></p><p>(Note: Only RFC 6455 peers support binary payloads. Attempts to use
<span class="RktVal">'</span><span class="RktVal">binary</span> payload-type with hybi-00 peers will signal an error.
See <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-payload-type~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-supports-payload-type?</a></span>.)</p><p>Returns either a string or a bytes, depending on
<span class="RktVar">payload-type</span>. If a specific <span class="RktVal">'</span><span class="RktVal">text</span> or
<span class="RktVal">'</span><span class="RktVal">binary</span> payload type is requested, the corresponding result
type is returned, or if <span class="RktVal">'</span><span class="RktVal">auto</span> is requested, the message&rsquo;s own
text/binary indicator bit is used to decide which to return. If
<span class="RktSym"><span class="badlink"><span class="RktValLink">eof</span></span></span> occurs mid-message, fragments so far received are
discarded and <span class="RktSym"><span class="badlink"><span class="RktValLink">eof</span></span></span> is returned.</p><p>Multi-fragment messages are transparently reassembled into a single
string or bytes.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-recv-evt))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-evt%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-recv-evt</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:payload-type</span><span class="hspace">&nbsp;</span><span class="RktVar">payload-type</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">evt?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">payload-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">auto</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">text</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">binary</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">auto</span></td></tr></table></blockquote></div><div class="SIntrapara">Produces a <font class="badlink"><span class="techoutside"><span class="techinside">synchronizable event</span></span></font> that effectively gives an asynchronous
version of <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span>. The <font class="badlink"><span class="techoutside"><span class="techinside">synchronization result</span></span></font> of the event is the
received message (either a string or a bytes, just the same as the way
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span> works) or <span class="RktSym"><span class="badlink"><span class="RktValLink">eof</span></span></span>.</div></p><p>The same caveats regarding <span class="RktVar">payload-type</span> apply here as for
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv%29%29" class="RktValLink" data-pltdoc="x">ws-recv</a></span>.</p><p>A <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span> value may be used as if it were an event produced
by <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-evt%29%29" class="RktValLink" data-pltdoc="x">ws-recv-evt</a></span>: using <span class="RktVar">c</span> alone as an event is
equivalent to using <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-evt%29%29" class="RktValLink" data-pltdoc="x">ws-recv-evt</a></span><span class="stt"> </span><span class="RktVar">c</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-recv-stream))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-recv-stream%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-recv-stream</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">input-port?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Receives a message from the remote peer, making the contents of the
message available through an input port.</div></p><p>(Note: Only RFC 6455 peers support streaming. Attempts to use this
procedure with hybi-00 peers will signal an error. See
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-supports-fragmentation~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-supports-fragmentation?</a></span>.)</p><p>Returns an input port from which the bytes or characters making up the
message can be read. An end-of-file from the resulting input port is
ambiguous: it does not separate the end of the message being read from
the end of the connection itself. Use <span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-closed~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-closed?</a></span> to
disambiguate, though beware of
<a href="https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use">time-of-check-to-time-of-use</a>
issues.</p><p>Multi-fragment messages are transparently reassembled. Fragment
boundaries are not preserved when reading from the returned input
port.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-close!))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-close%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-close!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">c</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:status</span><span class="hspace">&nbsp;</span><span class="RktVar">status</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:reason</span><span class="hspace">&nbsp;</span><span class="RktVar">reason</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">c</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">status</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">integer?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">1000</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">reason</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">""</span></td></tr></table></blockquote></div><div class="SIntrapara">Closes a connection. Has no effect if the connection is already
closed. The status code and reason are supplied to the remote peer in
the close frame.</div></p><p>(Note: hybi-00 peers do not have room in their wire protocol for the
status and reason codes. See
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-conn-signals-status-on-close~3f%29%29" class="RktValLink" data-pltdoc="x">ws-conn-signals-status-on-close?</a></span>.)</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._rfc6455-stream-buffer-size))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._rfc6455-stream-buffer-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">rfc6455-stream-buffer-size</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">integer?</span></span></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._rfc6455-stream-buffer-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">rfc6455-stream-buffer-size</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">size</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">size</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">integer?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Used when streaming the contents of an input-port given to
<span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-send%21%29%29" class="RktValLink" data-pltdoc="x">ws-send!</a></span>. Streamed message fragments will be no larger than
<span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._rfc6455-stream-buffer-size%29%29" class="RktValLink" data-pltdoc="x">rfc6455-stream-buffer-size</a></span><span class="RktPn">)</span> bytes each.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._hybi00-framing-mode))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._hybi00-framing-mode%29%29" class="RktValDef RktValLink" data-pltdoc="x">hybi00-framing-mode</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">new</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">old</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._hybi00-framing-mode%29%29" class="RktValDef RktValLink" data-pltdoc="x">hybi00-framing-mode</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">mode</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">or/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">new</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">old</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Used with <span class="emph">pre-</span>hybi-00 peers. Selects either the "new" or "old"
framing modes. You only have to worry about this if you&rsquo;re trying to
communicate with truly ancient, pre-hybi-00 peers, and then you no
doubt have bigger problems.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._net/rfc6455..rkt)._ws-idle-timeout))"></a><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-idle-timeout%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-idle-timeout</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: net/rfc6455 | Package: rfc6455"><span class="RktSym"><a href="#%28def._%28%28lib._net%2Frfc6455..rkt%29._ws-idle-timeout%29%29" class="RktValDef RktValLink" data-pltdoc="x">ws-idle-timeout</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">seconds</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seconds</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Idle timeout in seconds. If the interval between successive received
frames (of any type) exceeds this number of seconds, the connection
will be closed.</div></p><p>This parameter defaults to 300 seconds, i.e. five minutes.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;8.14&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.14&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;8.14&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>